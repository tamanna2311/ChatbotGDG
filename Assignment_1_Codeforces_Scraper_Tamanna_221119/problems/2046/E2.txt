E2. Cheops and a Contest (Hard Version)time limit per test4 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard output This is the hard version of the problem. The difference between the versions is that in this version, ğ‘šm is arbitrary. You can hack only if you solved all versions of this problem. There is a problem-solving competition in Ancient Egypt with ğ‘›n participants, numbered from 11 to ğ‘›n. Each participant comes from a certain city; the cities are numbered from 11 to ğ‘šm. There is at least one participant from each city.The ğ‘–i-th participant has strength ğ‘ğ‘–ai, specialization ğ‘ ğ‘–si, and wisdom ğ‘ğ‘–bi, so that ğ‘ğ‘–â‰¥ğ‘ğ‘–biâ‰¥ai. Each problem in the competition will have a difficulty ğ‘‘d and a unique topic ğ‘¡t. The ğ‘–i-th participant will solve the problem if   ğ‘ğ‘–â‰¥ğ‘‘aiâ‰¥d, i.e., their strength is not less than the problem's difficulty, or  ğ‘ ğ‘–=ğ‘¡si=t, and ğ‘ğ‘–â‰¥ğ‘‘biâ‰¥d, i.e., their specialization matches the problem's topic, and their wisdom is not less than the problem's difficulty. Cheops wants to choose the problems in such a way that each participant from city ğ‘–i will solve strictly more problems than each participant from city ğ‘—j, for all ğ‘–<ğ‘—i<j.Please find a set of at most 5ğ‘›5n problems, where the topics of all problems are distinct, so that Cheops' will is satisfied, or state that it is impossible.InputEach test contains multiple test cases. The first line contains the number of test cases ğ‘‡T (1â‰¤ğ‘‡â‰¤1041â‰¤Tâ‰¤104). The description of the test cases follows. The first line of each test case contains two integers ğ‘›n, ğ‘šm (2â‰¤ğ‘šâ‰¤ğ‘›â‰¤3â‹…1052â‰¤mâ‰¤nâ‰¤3â‹…105)Â â€” the number of participants and the number of cities.The following ğ‘›n lines describe the participants. The ğ‘–i-th line contains three integers â€”ğ‘ğ‘–ai, ğ‘ğ‘–bi, ğ‘ ğ‘–si (0â‰¤ğ‘ğ‘–,ğ‘ğ‘–,ğ‘ ğ‘–â‰¤1090â‰¤ai,bi,siâ‰¤109, ğ‘ğ‘–â‰¤ğ‘ğ‘–aiâ‰¤bi)Â â€” strength, wisdom, and specialization of the ğ‘–i-th participant, respectively.The next ğ‘šm lines describe the cities. In the ğ‘–i-th line, the first number is an integer ğ‘˜ğ‘–ki (1â‰¤ğ‘˜ğ‘–â‰¤ğ‘›1â‰¤kiâ‰¤n)Â â€” the number of participants from the ğ‘–i-th city. It is followed by ğ‘˜ğ‘–ki integers ğ‘ğ‘–,1,ğ‘ğ‘–,2,â€¦,ğ‘ğ‘–,ğ‘˜ğ‘–qi,1,qi,2,â€¦,qi,kiÂ â€” (1â‰¤ğ‘ğ‘–,ğ‘—â‰¤ğ‘›1â‰¤qi,jâ‰¤n, 1â‰¤ğ‘—â‰¤ğ‘˜ğ‘–1â‰¤jâ‰¤ki)Â â€” the indices of the participants from this city. It is guaranteed that each participant is mentioned exactly once.It is guaranteed that the sum of ğ‘›n over all test cases does not exceed 3â‹…1053â‹…105. OutputFor each test case, if there exists a set of problems that satisfies Cheops' conditions, then in the first line output a single integer ğ‘p (1â‰¤ğ‘â‰¤5ğ‘›1â‰¤pâ‰¤5n)Â â€” the number of problems in your solution.Then output ğ‘p lines, each containing two integers ğ‘‘d and ğ‘¡t (0â‰¤ğ‘‘,ğ‘¡â‰¤1090â‰¤d,tâ‰¤109)Â â€” the difficulty and topic of the respective problem. The topics must be distinct.If there is no set of problems that meets Cheops' wishes, print âˆ’1âˆ’1 instead.ExampleInputCopy25 25 7 16 7 23 9 25 10 34 4 12 1 23 3 4 52 21 2 11 2 11 21 1OutputCopy7
6 4
6 5
5 6
5 7
4 8
4 9
7 1
-1