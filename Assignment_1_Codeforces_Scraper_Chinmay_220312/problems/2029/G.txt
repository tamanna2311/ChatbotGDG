G. Balanced Problemtime limit per test3 secondsmemory limit per test1024 megabytesinputstandard inputoutputstandard outputThere is an array ğ‘a consisting of ğ‘›n integers. Initially, all elements of ğ‘a are equal to 00.Kevin can perform several operations on the array. Each operation is one of the following two types: Prefix additionÂ â€” Kevin first selects an index ğ‘¥x (1â‰¤ğ‘¥â‰¤ğ‘›1â‰¤xâ‰¤n), and then for each 1â‰¤ğ‘—â‰¤ğ‘¥1â‰¤jâ‰¤x, increases ğ‘ğ‘—aj by 11;  Suffix additionÂ â€” Kevin first selects an index ğ‘¥x (1â‰¤ğ‘¥â‰¤ğ‘›1â‰¤xâ‰¤n), and then for each ğ‘¥â‰¤ğ‘—â‰¤ğ‘›xâ‰¤jâ‰¤n, increases ğ‘ğ‘—aj by 11.In the country of KDOI, people think that the integer ğ‘£v is balanced. Thus, Iris gives Kevin an array ğ‘c consisting of ğ‘›n integers and defines the beauty of the array ğ‘a as follows: Initially, set ğ‘=0b=0;  For each 1â‰¤ğ‘–â‰¤ğ‘›1â‰¤iâ‰¤n, if ğ‘ğ‘–=ğ‘£ai=v, add ğ‘ğ‘–ci to ğ‘b;  The beauty of ğ‘a is the final value of ğ‘b.Kevin wants to maximize the beauty of ğ‘a after all the operations. However, he had already performed ğ‘šm operations when he was sleepy. Now, he can perform an arbitrary number (possibly zero) of new operations.You have to help Kevin find the maximum possible beauty if he optimally performs the new operations.However, to make sure that you are not just rolling the dice, Kevin gives you an integer ğ‘‰V, and you need to solve the problem for each 1â‰¤ğ‘£â‰¤ğ‘‰1â‰¤vâ‰¤V.InputEach test contains multiple test cases. The first line of the input contains a single integer ğ‘¡t (1â‰¤ğ‘¡â‰¤10001â‰¤tâ‰¤1000)Â â€” the number of test cases. The description of test cases follows.The first line of each test case contains three integers ğ‘›n, ğ‘šm, and ğ‘‰V (1â‰¤ğ‘›,ğ‘šâ‰¤2â‹…1051â‰¤n,mâ‰¤2â‹…105, 1â‰¤ğ‘‰â‰¤20001â‰¤Vâ‰¤2000)Â â€” the length of the array ğ‘a, the number of initial operations, and the number that Kevin gives you.The second line contains ğ‘›n integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›c1,c2,â€¦,cn (1â‰¤ğ‘ğ‘–â‰¤1091â‰¤ciâ‰¤109)Â â€” the elements in the array ğ‘c.Then ğ‘šm lines follow, the ğ‘–i-th line containing a character ğ‘œğ‘op and an integer ğ‘¥x (ğ‘œğ‘=ğ™»op=L or ğšR, 1â‰¤ğ‘¥â‰¤ğ‘›1â‰¤xâ‰¤n)Â â€” the type of the ğ‘–i-th operation and the selected index.  If ğ‘œğ‘=ğ™»op=L, this operation is a prefix addition on index ğ‘¥x;  If ğ‘œğ‘=ğšop=R, this operation is a suffix addition on index ğ‘¥x. It is guaranteed that:  the sum of ğ‘›n over all test cases does not exceed 2â‹…1052â‹…105;  the sum of ğ‘šm over all test cases does not exceed 2â‹…1052â‹…105;  the sum of ğ‘‰2V2 over all test cases does not exceed 4â‹…1064â‹…106. OutputFor each test case, output ğ‘‰V integers in a single line, the ğ‘–i-th integer denoting the maximum possible beauty after Kevin performs some new operations when ğ‘£=ğ‘–v=i.ExampleInputCopy53 3 21 2 4L 3R 3L 13 3 25 1 4L 3R 3L 15 4 51 1 1 1 1L 3R 2L 5L 410 12 910 9 8 7 6 5 4 3 2 1L 2L 4R 4R 4L 6R 8L 3L 2R 1R 10L 8L 11 1 41000000000L 1OutputCopy2 6
1 9
0 1 3 5 5
0 0 0 6 25 32 35 44 51
1000000000 1000000000 1000000000 1000000000
NoteIn the first test case, the array ğ‘a changes as follows for the initial operations: [0,0,0]âˆ’â†’âˆ’ğ™»Â 3[1,1,1]âˆ’â†’âˆ’ğšÂ 3[1,1,2]âˆ’â†’âˆ’ğ™»Â 1[2,1,2][0,0,0]â†’LÂ 3[1,1,1]â†’RÂ 3[1,1,2]â†’LÂ 1[2,1,2].  For ğ‘£=1v=1, it is optimal to not perform any new operations, and the beauty is ğ‘=ğ‘2=2b=c2=2;  For ğ‘£=2v=2, it is optimal to perform a prefix addition operation on index 22. After that, ğ‘a becomes [3,2,2][3,2,2], and the beauty is ğ‘=ğ‘2+ğ‘3=6b=c2+c3=6. In the second test case, for both ğ‘£=1v=1 and ğ‘£=2v=2, it is optimal to not perform any new operations.